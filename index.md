### 1、背景

项目中涉及对nfs目录的管理，之前只有名字，以表格列表的形式展示，这样体现不出这是文件夹/文件的特点，且在逻辑上需要对文件夹有个归属分类。于是我封装了文件系统、右键列表两个组件，重写了后端逻辑。

### 2、思路

* 前端：使用React（Dva+AntD）完成两个组件的封装，模拟双击、右击效果。将目录路径通过URL栏展示，用browerHistory+location监听，url改变就调用http接口获得该目录下文件信息。
* 后端：使用Flask构建服务，
  * 首先数据库（ORM操作）要存储第一层目录名。这样比直接读取有几个好处，更方便的文件夹进行分类归属、查询首层目录更快。
  * 解决了第一层目录的问题，就是拼子目录路径的事了。我的方法，因为各种点击效果都是在前端触发，所以由前端完成path参数拼接，传给后端，后端在根据path进行I/O操作。
  * 支持对文本文件在线编辑

### 3、问题

#### 1、删除

- 描述：数据库数据假删，实际不删。删除后在新建相同文件夹会报错


- 解决：为区分文件夹名称，前端提交增加时间戳，展示去掉时间戳

- 相关代码

  ```javascript
  // 新建
  `${folder}${Date.parse(new Date())/1000}`
  // 展示,（兼容之前文件夹名称）
  /^\d{10}$/.test(value.name.slice(-10))?value.name.slice(0,-10):value.name
  ```


###4、开发文档

* 见同目录

### 5、代码

* 现在代码在项目中，等有空会单独抽离。。。